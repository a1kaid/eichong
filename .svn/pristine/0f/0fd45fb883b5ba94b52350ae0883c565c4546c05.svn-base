(function(){template.openTag="<!--[";template.closeTag="]-->";template.helper("$absImg",function(a){if(!a){return config.defaultImg}if(a&&a.indexOf("http://")==0){return a}return config.imageServer+a});template.helper("$userImg",function(a){if(!a){return config.imageServer+"/tempweb/images/img/person_icon.png"}if(a&&a.indexOf("http://")==0){return a}return config.imageServer+a});template.helper("$formatDate",function(c,b,a){if(c){if(c.length==10){c=c+"000"}return Tools.formatDate(c,b)}else{return a||"--"}});template.helper("$encodeUrl",function(a){return encodeURIComponent(a)});template.helper("$formatCurrency1",function(e,a,d){if(!e){return a||"--"}var c=e.toString().length%3;var b="";if(c==1){b="00"}else{if(c==2){b="0"}}e=b+e;e=e.replace(/(\d{3})/g,"$1,");e=e.substring(0,e.length-1);if(b.length>0){e=e.replace(b,"")}return e+d||""});template.helper("$convertRN",function(a){if(!a){return"--"}return a.replace(/\r\n/gi,"<br/>")});template.helper("$addClassByIdx",function(b,a,c){if(b==a){return c||""}});template.helper("$formatCurrency",function(c,b){if(!c){return"--"}var e,d,a=c.indexOf(".");if(a>0){e=c.substring(0,a);d=c.substring(a)}else{e=c;d=".00"}return e+'<span class="f-s">'+d+"</span>"});template.helper("$ellipsis",function(c,b){if(!c){return""}var a=c.replace(/[^\x00-\xff]/g,"__").length;if(a/2>b){return c.substring(0,b)+"..."}return c})})();var log=function(a){if(typeof console!="undefined"){console.log(a)}};$.fn.numberLimit=function(){this.bind("keypress",function(b){var a=(b.keyCode?b.keyCode:b.which);return a>=48&&a<=57});this.bind("blur",function(){if(this.value.lastIndexOf(".")==(this.value.length-1)){this.value=this.value.substr(0,this.value.length-1)}else{if(isNaN(this.value)){this.value=""}}});this.bind("paste",function(){var a=clipboardData.getData("text");if(!/\D/.test(a)){}value=a.replace(/^0*/,"");return false});this.bind("dragenter",function(){return false});this.bind("keyup",function(){if(/(^0+)/.test(this.value)){this.value=this.value.replace(/^0*/,"")}})};Date.prototype.format=function(b){var c={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(b)){b=b.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length))}for(var a in c){if(new RegExp("("+a+")").test(b)){b=b.replace(RegExp.$1,RegExp.$1.length==1?c[a]:("00"+c[a]).substr((""+c[a]).length))}}return b};String.prototype.isSpaces=function(){for(var a=0;a<this.length;a+=1){var b=this.charAt(a);if(b!=" "&&b!="\n"&&b!="\t"&&b!="\r"){return false}}return true};String.prototype.isValidMail=function(){return(new RegExp(/^\w+((-\w+)|(\.\w+))*\@[A-Za-z0-9]+((\.|-)[A-Za-z0-9]+)*\.[A-Za-z0-9]+$/).test(this))};String.prototype.isPhone=function(){return(new RegExp(/^1\d{10}?$/).test(this))};String.prototype.isEmpty=function(){return(/^\s*$/.test(this))};String.prototype.isValidPwd=function(){return(new RegExp(/^([_]|[a-zA-Z0-9]){8,16}$/).test(this))};String.prototype.isPostCode=function(){return(new RegExp(/^\d{6}?$/).test(this))};String.prototype.getQueryValue=function(d){var e=this,f=new Array();if(e.length>1){var a=e.indexOf("?");e=e.substring(a+1,e.length)}else{e=null}if(e){for(var c=0;c<e.split("&").length;c++){f[c]=e.split("&")[c]}}for(var b=0;b<f.length;b++){if(f[b].split("=")[0]==d){return decodeURI(f[b].split("=")[1])}}return""};var formJson=function(c){var d={};var b=$(c).serializeArray();$.each(b,function(){if(d[this.name]!==undefined){if(!d[this.name].push){d[this.name]=[d[this.name]]}d[this.name].push(this.value||"")}else{d[this.name]=this.value||""}});return d};var Ajax={options:{eventName:"dh-eventName",childSelecter:"dh-child-selecter",eventType:"dh-event-type"},response:undefined,pageRequest:function(f,h,e){var d=f.renderFor||"data-list-tmpl",c=f.renderEle||"#data-list",g=this,b=f.pageFor||"page-tmpl",a=f.pageEle||"#page-dom";$.ajax({url:f.url,data:f.data,type:f.type||"GET",timeout:7000,cache:false,beforeSend:function(){g.showLoad((f.dom||$(c)))},complete:function(){g.hideLoad((f.dom||$(c)))}}).then(function(k,n,m){if(!g.isSuccess(k)){log("Request FAILED!FAILED URL"+f.url)}if($("#"+d).length){var j=template.render(d,{list:g.response.data||[]});$(c).html(j)}if($("#"+b).length){var l=template.render(b,{totalPage:g.response.totalPage,pageStart:g.response.pageStart,pageEnd:g.response.pageEnd,cPage:g.response.currentPage});$(a).html(l)}if($.isFunction(h)){h(g.response)}}).done(function(k,j){if($.isFunction(e)){e()}}).fail(function(j,l,k){g.hideLoad((f.dom||$(c)));log(l+":"+f.url)})},queryDetail:function(d,g,c,e){var b=d.renderFor||"detail-data-tmpl",a=d.renderEle||"#detail-data",f=this;$.ajax({url:d.url,data:d.data,type:d.type||"GET",timeout:7000,beforeSend:function(){f.showLoad((d.dom||$(a)))},complete:function(){f.hideLoad((d.dom||$(a)))}}).then(function(j){if(!f.isSuccess(j)){log("Request FAILED!FAILED URL"+d.url)}if($("#"+b).length&&f.response.data){!f.response.data.length?f.response.data=[f.response.data]:"";var h=template.render(b,f.response.data[0]);$(a).html(h)}if($.isFunction(g)){g(f.response)}}).done(function(){if($.isFunction(c)){c()}}).fail(function(h,k,j){f.hideLoad((d.dom||$(a)));log(k+":"+d.url);if($.isFunction(e)){e(k)}})},submitForm:function(c,f,a){var d,e=this,b=!!c.data.length;if(b){d=c.data.serializeArray();c.data.find('input[type="submit"]').attr("disabled",true)}else{d=c.data}$.ajax({url:c.url,data:d,type:c.type||"POST",timeout:7000}).then(function(g){if(!e.isSuccess(g)){log("Request FAILED!FAILED URL"+c.url)}var h=e.checkFrom();if(h&&e.response.code==="OK"){location.href=decodeURIComponent(h);return}if(c.backUrl&&e.response.code==="OK"){if(c.backUrl==="self"){c.backUrl=""}location.href=c.backUrl;return}if($.isFunction(f)){f(e.response)}}).done(function(){if(b){c.data.find('input[type="submit"]').removeAttr("disabled")}if($.isFunction(a)){a()}}).fail(function(g,j,h){log(j+":"+c.url);if(b){c.data.find('input[type="submit"]').removeAttr("disabled")}})},custom:function(a,d,b){var c=this;$.ajax({url:a.url,data:a.data,type:a.type||"GET",timeout:7000}).then(function(e,g,f){if(!c.isSuccess(e)){log("Request FAILED!FAILED URL"+a.url)}if(typeof d=="function"){d(c.response)}},function(e,g,f){log(g+":"+a.url);if(typeof b=="function"){b(e,g,f)}}).fail(function(e,g,f){c.hideLoad((a.dom));log(g+":"+a.url)})},isSuccess:function(response){try{this.response=eval("("+response+")");return(!response?false:(this.response.code==="OK")?true:false)}catch(e){log("Parse response error! Message:"+e.message)}return false},showLoad:function(c,a){if(!c||!c.length){return}c.html("");if(a){a.html("")}var b=document.createElement("img");b.src=config.defaultLoadImg;b.className="ajax-load-img";c.append($(b))},hideLoad:function(b){if(b&&b.length){var a=b.find(".ajax-load-img");a?a.remove():""}},bindDomEvent:function(d){var e=this,a=window[$(d).attr(e.options.eventName)],b=$(d).attr(e.options.childSelecter),c=$(d).attr(e.options.eventType)||"click";typeof a=="function"?$(d).on(c,b,function(f){f.preventDefault();a($(this))}):""},setOptions:function(a){if(typeof a!="object"){return}this.extendObj(this.options,a)},extendObj:function(){var b=arguments[0]||{},a=arguments[1]||{};for(i in a){b[i]=a[i]}},checkFrom:function(){return location.href.getQueryValue("from")}};var Tools=(function(){var d,a,c,e,b;return{formatDate:function(k,o){var n="yyyy-MM-dd hh:mm";switch(o){case 1:n="yyyy年M月d日";break;case 2:n="hh:mm";break;case 3:n="yyyy.M.d";break;case 4:n="yyyy-MM-dd hh:mm:ss";break;case 5:n="yyyy年MM月";break;case 6:n="yyyy-MM-dd";break;case 7:n="yyyy/MM/dd hh:mm:ss";break;case 8:n="yyyy/MM/dd";break;case 9:n="hh:mm:ss";break;default:n=!!o?o:n;break}if(isNaN(k)||k==null){return k}else{if(typeof(k)=="object"){var p=dd.getFullYear(),g=dd.getMonth()+1,l=dd.getDate();if(g<10){g="0"+g}var j=p+"-"+g+"-"+l;var h=j.match(/(\d+)/g);var f=new Date(h[0],h[1]-1,h[2]);return f.format(n)}else{var f=new Date(parseInt(k));return f.format(n)}}},getWindow:function(){return{width:window.innerWidth,height:window.innerHeight}},getDocument:function(){var f=document.documentElement||document.body;return{width:f.clientWidth,height:f.clientHeight}},getScreen:function(){return{width:screen.width,height:screen.height}},showOrHideScrollBar:function(f){d=d||function(g){g.preventDefault()};(document.documentElement||document.body).style.overflow=f?"auto":"hidden";if(f){document.removeEventListener("touchmove",d,false)}else{document.addEventListener("touchmove",d,false)}}}})();var Cookie={ACCOUNT:"com.wm.user",USERNAME:"com.wm.username",REMEMBER:"remember_flag",CCITY:"current_city",get:function(a){var c="(?:;)?"+a+"=([^;]*);?";var b=new RegExp(c);if(b.test(document.cookie)){try{return unescape(RegExp["$1"])}catch(d){return null}}else{return null}},set:function(b,c,a){document.cookie=b+"="+escape(c)+((a==null)?"":";expires="+a)+"; path=/"},remove:function(a){Cookie.set(a,"",-1)},getExpDate:function(c,a,d){var b=new Date;if(typeof c=="number"&&typeof a=="number"&&typeof a=="number"){return b.setDate(b.getDate()+(parseInt(c))),b.setHours(b.getHours()+parseInt(a)),b.setMinutes(b.getMinutes()+parseInt(d)),b.toGMTString()}}};